
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScrollScape || 3D Website Animation Toolkit</title>
    <link rel="icon" type="image/ico" href="scroll_icon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
<style>
        #scene-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 0;
            pointer-events: none;
            background: transparent !important;
        }
        
        .loading-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            color: white;
            z-index: 1000;
        }
        
        
  </style></head>
<body><div id="scene-container"></div><div class="loading-indicator" id="loading">Initializing 3D Scene...</div>
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-scroll w-8 h-8 text-purple-300" id="nav-logo"><path d="M19 17V5a2 2 0 0 0-2-2H4"></path><path d="M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3"></path> </svg><!-- <img src="scroll_icon.svg"  alt="Scroll nav-logo" id="nav-logo"> -->
                <a href="#home" class="nav-logo">ScrollScape</a>
            </div>
            <ul class="nav-links" id="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#how-it-works">How It Works</a></li>
                <li><a href="#features">Features</a></li>
                <li><a href="#use-cases">Use Cases</a></li>
                <li><a href="#testimonials">Testimonials</a></li>
            </ul>
            <div class="nav-toggle" id="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="container">
            <div class="hero-content">
                <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-scroll w-8 h-8 text-purple-300" id="svglogo"><path d="M19 17V5a2 2 0 0 0-2-2H4"></path><path d="M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3"></path></svg>
                <div class="logo" data-aos="fade-up">ScrollScape</div>
                <h1 data-aos="fade-up" data-aos-delay="200">Where Scrolls Meet Cyberspace</h1>
                <p data-aos="fade-up" data-aos-delay="400">Craft immersive web animations and transform Scrolling into mini-adventure.</p>
                <div class="cta-buttons" data-aos="fade-up" data-aos-delay="600">
                    <a href="./editor/" class="btn btn-primary">Start Animating - FREE</a>
                    <a href="#features" class="btn btn-secondary">Explore Features</a>
                </div>
            </div>
        </div>
        <div class="scroll-indicator"></div>
    </section>

    <!-- How ScrollScape Works Section -->
    <section id="how-it-works" class="how-it-works">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">How ScrollScape Works</h2>
            <div class="works-grid">
                <div class="work-step" data-aos="fade-up" data-aos-delay="100">
                    <div class="step-number">1</div>
                    <span class="step-icon">üé®</span>
                    <h3>Animate 3D Model</h3>
                    <p>Design and animate your 3D models with our intuitive drag-and-drop interface. Create stunning visual effects with real-time preview capabilities.</p>
                </div>
                <div class="work-step" data-aos="fade-up" data-aos-delay="200">
                    <div class="step-number">2</div>
                    <span class="step-icon">üîó</span>
                    <h3>Provide Link to Online Model</h3>
                    <p>Import existing 3D models from online libraries or your own repositories. Support for popular formats including GLTF, OBJ, and FBX.</p>
                </div>
                <div class="work-step" data-aos="fade-up" data-aos-delay="300">
                    <div class="step-number">3</div>
                    <span class="step-icon">üì§</span>
                    <h3>Upload HTML File</h3>
                    <p>Upload your existing HTML file or start from scratch. Our editor integrates seamlessly with your current web projects and frameworks.</p>
                </div>
                <div class="work-step" data-aos="fade-up" data-aos-delay="400">
                    <div class="step-number">4</div>
                    <span class="step-icon">‚¨áÔ∏è</span>
                    <h3>Download Animated File</h3>
                    <p>Export your completed scroll-animated scene as optimized HTML, CSS, and JavaScript files ready for deployment on any web platform.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="features">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">What Makes ScrollScape Magical</h2>
            <div class="features-grid">
                <div class="feature-card" id="feature-card1" data-aos="fade-up" data-aos-delay="100">
                    <span class="feature-icon">üé®</span>
                    <h3>Drag-and-Drop 3D Scene Builder</h3>
                    <p>Intuitive visual editor that lets you craft stunning 3D scenes without writing a single line of code. Just drag, drop, and watch your vision come to life.</p>
                </div>
                <div class="feature-card" id="feature-card2" data-aos="fade-up" data-aos-delay="200">
                    <span class="feature-icon">‚è±Ô∏è</span>
                    <h3>Scroll Timeline Control</h3>
                    <p>Synchronize your animations perfectly with scroll position. Create cinematic experiences that respond fluidly to user interaction.</p>
                </div>
                <div class="feature-card" id="feature-card3" data-aos="fade-up" data-aos-delay="300">
                    <span class="feature-icon">üîß</span>
                    <h3>WebGL/Three.js Compatible</h3>
                    <p>Built on industry-standard technologies. Export your creations as optimized WebGL scenes compatible with any modern web framework.</p>
                </div>
                <div class="feature-card" id="feature-card4" data-aos="fade-up" data-aos-delay="400">
                    <span class="feature-icon">üìù</span>
                    <h3>Instant Embeddable Snippet</h3>
                    <p>Generate clean, lightweight code snippets ready to embed in any website. One click to copy, paste, and deploy your masterpiece.</p>
                </div>
                <div class="feature-card" id="feature-card5" data-aos="fade-up" data-aos-delay="500">
                    <span class="feature-icon">üëÄ</span>
                    <h3>Real-time Animation Preview</h3>
                    <p>See your changes instantly with our live preview engine. Test scroll interactions, timing, and effects in real-time as you build.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Use Cases Section -->
    <section id="use-cases" class="use-cases">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">Bring Stories to Life on the Web</h2>
            <div class="use-cases-grid">
                <div class="use-case-card" data-aos="zoom-in" data-aos-delay="100">
                    <span class="use-case-icon">üíº</span>
                    <h3>Interactive Portfolio Hero</h3>
                    <p>Transform your portfolio with scroll-driven 3D animations that showcase your work in an unforgettable way. Stand out from the crowd with dynamic, engaging presentations that tell your professional story.</p>
                </div>
                <div class="use-case-card" data-aos="zoom-in" data-aos-delay="200">
                    <span class="use-case-icon">üì¶</span>
                    <h3>Product Showcases with 3D</h3>
                    <p>Revolutionize e-commerce with immersive product experiences. Let customers explore products from every angle with smooth 3D rotations and scroll-triggered reveals that boost engagement and conversions.</p>
                </div>
                <div class="use-case-card" data-aos="zoom-in" data-aos-delay="300">
                    <span class="use-case-icon">üìä</span>
                    <h3>Immersive Data Storytelling</h3>
                    <p>Transform complex data into compelling visual narratives. Create scroll-driven infographics and interactive charts that guide viewers through your insights with cinematic flair.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section id="testimonials" class="testimonials">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">Creators Love ScrollScape</h2>
            <div class="testimonials-grid">
                <div class="testimonial-card" data-aos="fade-right" data-aos-delay="100">
                    <p class="testimonial-text">ScrollScape transformed my portfolio completely. The scroll animations are buttery smooth, and clients are blown away by the immersive experience. It's like having a Hollywood VFX team in your browser.</p>
                    <div class="testimonial-author">Maya Chen</div>
                    <div class="testimonial-role">Creative Director, Pixel Dreams Studio</div>
                </div>
                <div class="testimonial-card" data-aos="fade-left" data-aos-delay="200">
                    <p class="testimonial-text">As a developer who's not great with design, ScrollScape is a game-changer. I can create stunning 3D experiences without touching complex WebGL code. My clients think I'm a wizard!</p>
                    <div class="testimonial-author">Alex Rodriguez</div>
                    <div class="testimonial-role">Full-Stack Developer</div>
                </div>
                <div class="testimonial-card" data-aos="fade-right" data-aos-delay="300">
                    <p class="testimonial-text">The real-time preview feature is incredible. I can iterate on scroll animations instantly and see exactly how they'll feel to users. It's revolutionized our design process.</p>
                    <div class="testimonial-author">Sarah Kim</div>
                    <div class="testimonial-role">UX Designer, TechFlow Inc</div>
                </div>
                <div class="testimonial-card" data-aos="fade-left" data-aos-delay="400">
                    <p class="testimonial-text">ScrollScape helped us create the most engaging product showcase we've ever had. Sales increased 40% after launching our new 3D product explorer. Absolutely phenomenal tool.</p>
                    <div class="testimonial-author">Marcus Thompson</div>
                    <div class="testimonial-role">E-commerce Manager</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-scroll w-8 h-8 text-purple-300" id="footer-logo"><path d="M19 17V5a2 2 0 0 0-2-2H4"></path><path d="M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3"></path> </svg><!-- <img src="scroll_icon.svg"  alt="Scroll nav-logo" id="nav-logo"> -->
                ScrollScape</div>
                <div class="footer-links">
                    <a href="https://www.linkedin.com/in/prodyumna-pal/">Developer</a>
                    <a href="https://github.com/SparkScratch-P/scrollscape">GitHub</a>
                    <a href="https://github.com/SparkScratch-P/scrollscape-animator-toolkit">Source</a>
                    <a href="#blog">Blog</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 ScrollScape. Crafted with ‚ú® for the future of web animation.</p>
            </div>
        </div>
    </footer>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="script.js"></script>

    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.158.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.158.0/examples/jsm/"
        }
    }
    </script>
    
    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        
        let scene, camera, renderer, currentModel, mixer;
        let isModelLoaded = false;
        let gltfAnimations = [];
        let currentAnimationAction = null;
        const keyframes = [
  {
    "id": "keyframe-1752392314879",
    "name": "Frame 1",
    "startScroll": 0,
    "endScroll": 20,
    "duration": 1000,
    "transform": {
      "position": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": -3,
          "y": 0.5,
          "z": 1
        }
      },
      "rotation": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 0,
          "y": 3.141592653589793,
          "z": 0
        }
      },
      "scale": {
        "start": {
          "x": 1,
          "y": 1,
          "z": 1
        },
        "end": {
          "x": 1.5,
          "y": 1.5,
          "z": 1.5
        }
      }
    },
    "camera": {
      "position": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 5
        },
        "end": {
          "x": 2,
          "y": 2,
          "z": 5
        }
      },
      "target": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 0,
          "y": 0,
          "z": 0
        }
      },
      "fov": {
        "start": 45,
        "end": 45
      }
    },
    "interactions": {
      "onClick": "",
      "onHover": "",
      "draggable": false
    },
    "easing": "easeInOut",
    "autoRotate": false,
    "autoRotateSpeed": {
      "x": 0.005,
      "y": 0.01
    },
    "playAnimation": false,
    "selectedAnimation": null,
    "availableAnimations": []
  },
  {
    "id": "keyframe-1752401686524",
    "name": "Frame 2",
    "startScroll": 20,
    "endScroll": 40,
    "duration": 1000,
    "transform": {
      "position": {
        "start": {
          "x": -3,
          "y": 0.5,
          "z": 1
        },
        "end": {
          "x": 2,
          "y": 0,
          "z": 0
        }
      },
      "rotation": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 0,
          "y": 3.141592653589793,
          "z": 0
        }
      },
      "scale": {
        "start": {
          "x": 1,
          "y": 1,
          "z": 1
        },
        "end": {
          "x": 1.5,
          "y": 1.5,
          "z": 1.5
        }
      }
    },
    "camera": {
      "position": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 5
        },
        "end": {
          "x": 2,
          "y": 2,
          "z": 5
        }
      },
      "target": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 0,
          "y": 0,
          "z": 0
        }
      },
      "fov": {
        "start": 45,
        "end": 45
      }
    },
    "interactions": {
      "onClick": "",
      "onHover": "",
      "draggable": false
    },
    "easing": "easeInOut",
    "autoRotate": false,
    "autoRotateSpeed": {
      "x": 0.005,
      "y": 0.01
    },
    "playAnimation": false,
    "selectedAnimation": null,
    "availableAnimations": []
  },
  {
    "id": "keyframe-1752401847122",
    "name": "Frame 3",
    "startScroll": 40,
    "endScroll": 60,
    "duration": 1000,
    "transform": {
      "position": {
        "start": {
          "x": 2,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 1,
          "y": 3,
          "z": 3
        }
      },
      "rotation": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 0,
          "y": 3.5,
          "z": 0
        }
      },
      "scale": {
        "start": {
          "x": 1.5,
          "y": 1.5,
          "z": 1.5
        },
        "end": {
          "x": 7,
          "y": 7,
          "z": 7
        }
      }
    },
    "camera": {
      "position": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 5
        },
        "end": {
          "x": 2,
          "y": 2,
          "z": 5
        }
      },
      "target": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 0,
          "y": 0,
          "z": 0
        }
      },
      "fov": {
        "start": 45,
        "end": 45
      }
    },
    "interactions": {
      "onClick": "",
      "onHover": "",
      "draggable": false
    },
    "easing": "easeInOut",
    "autoRotate": false,
    "autoRotateSpeed": {
      "x": 0.005,
      "y": 0.01
    },
    "playAnimation": false,
    "selectedAnimation": null,
    "availableAnimations": []
  },
  {
    "id": "keyframe-1752402215176",
    "name": "Frame 4",
    "startScroll": 60,
    "endScroll": 80,
    "duration": 1000,
    "transform": {
      "position": {
        "start": {
          "x": 1,
          "y": 3,
          "z": 3
        },
        "end": {
          "x": 1,
          "y": 1.2,
          "z": 1
        }
      },
      "rotation": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 0,
          "y": 3.141592653589793,
          "z": 0
        }
      },
      "scale": {
        "start": {
          "x": 7,
          "y": 7,
          "z": 7
        },
        "end": {
          "x": 1,
          "y": 1,
          "z": 1
        }
      }
    },
    "camera": {
      "position": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 5
        },
        "end": {
          "x": 2,
          "y": 2,
          "z": 5
        }
      },
      "target": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 0,
          "y": 0,
          "z": 0
        }
      },
      "fov": {
        "start": 45,
        "end": 45
      }
    },
    "interactions": {
      "onClick": "",
      "onHover": "",
      "draggable": false
    },
    "easing": "easeInOut",
    "autoRotate": false,
    "autoRotateSpeed": {
      "x": 0.005,
      "y": 0.01
    },
    "playAnimation": false,
    "selectedAnimation": null,
    "availableAnimations": []
  },
  {
    "id": "keyframe-1752402311916",
    "name": "Frame 5",
    "startScroll": 80,
    "endScroll": 100,
    "duration": 1000,
    "transform": {
      "position": {
        "start": {
          "x": 1,
          "y": 1.2,
          "z": 1
        },
        "end": {
          "x": 0,
          "y": 0,
          "z": 0
        }
      },
      "rotation": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 0,
          "y": 3.5,
          "z": 0
        }
      },
      "scale": {
        "start": {
          "x": 1,
          "y": 1,
          "z": 1
        },
        "end": {
          "x": 1.5,
          "y": 1.5,
          "z": 1.5
        }
      }
    },
    "camera": {
      "position": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 5
        },
        "end": {
          "x": 2,
          "y": 2,
          "z": 5
        }
      },
      "target": {
        "start": {
          "x": 0,
          "y": 0,
          "z": 0
        },
        "end": {
          "x": 0,
          "y": 0,
          "z": 0
        }
      },
      "fov": {
        "start": 45,
        "end": 45
      }
    },
    "interactions": {
      "onClick": "",
      "onHover": "",
      "draggable": false
    },
    "easing": "easeInOut",
    "autoRotate": false,
    "autoRotateSpeed": {
      "x": 0.005,
      "y": 0.01
    },
    "playAnimation": false,
    "selectedAnimation": null,
    "availableAnimations": []
  }
];
        
        console.log('Starting 3D scene initialization...');
        
        // Initialize Three.js scene
        function initScene() {
            console.log('Initializing Three.js scene...');
            
            // Create scene
            scene = new THREE.Scene();
            scene.background = null;
            
            // Create camera
            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 5);
            
            // Create renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            renderer.setClearColor(0x000000, 0);
            
            document.getElementById('scene-container').appendChild(renderer.domElement);
            
            // Enhanced lighting setup
            const ambientLight = new THREE.AmbientLight(0x404040, 1.5);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 2.0);
            directionalLight.position.set(10, 10, 5);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);
            
            const hemisphereLight = new THREE.HemisphereLight(0x87CEEB, 0x654321, 1.0);
            scene.add(hemisphereLight);
            
            // Multiple point lights for better illumination
            const pointLight1 = new THREE.PointLight(0xffffff, 2.0, 100);
            pointLight1.position.set(5, 5, 5);
            scene.add(pointLight1);
            
            const pointLight2 = new THREE.PointLight(0xffffff, 2.0, 100);
            pointLight2.position.set(-5, -5, 5);
            scene.add(pointLight2);
            
            const pointLight3 = new THREE.PointLight(0xff6b6b, 1.5, 50);
            pointLight3.position.set(0, 10, 0);
            scene.add(pointLight3);
            
            console.log('Scene setup complete, creating default model...');
            
            // Create default visible model
            createCubeModel();
            
            // Try to load external model
            setTimeout(() => {
                loadExternalModel();
            }, 1000);
            
            // Start animation loop
            animate();
            
            // Hide loading after scene is ready
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
            }, 500);
            
            console.log('Scene initialized successfully');
        }
        
        function createCubeModel() {
            console.log('Creating cube model...');
            
            // Remove existing model
            if (currentModel) {
                scene.remove(currentModel);
            }
            
            const geometry = new THREE.BoxGeometry(2, 2, 2);
            const material = new THREE.MeshStandardMaterial({ 
                color: 0x4f46e5,
                metalness: 0.5,
                roughness: 0.3,
                emissive: 0x112244,
                emissiveIntensity: 0.3
            });
            
            currentModel = new THREE.Mesh(geometry, material);
            currentModel.name = 'cube';
            currentModel.position.set(0, 0, 0);
            currentModel.castShadow = true;
            currentModel.receiveShadow = true;
            
            scene.add(currentModel);
            isModelLoaded = true;
            
            console.log('Cube model created and visible');
        }
        
        function loadExternalModel() {
            console.log('Attempting to load external 3D model...');
            
            const loader = new GLTFLoader();
            const modelUrl = 'https://sparkscratch-p.github.io/assets/3D/rover.glb';
            
            console.log('Loading model from:', modelUrl);
            
            loader.load(
                modelUrl,
                function(gltf) {
                    console.log('External model loaded successfully:', gltf);
                    
                    // Remove current model
                    if (currentModel) {
                        scene.remove(currentModel);
                    }
                    
                    currentModel = gltf.scene;
                    currentModel.name = 'external';
                    
                    // Extract animations
                    if (gltf.animations && gltf.animations.length > 0) {
                        gltfAnimations = gltf.animations;
                        mixer = new THREE.AnimationMixer(currentModel);
                        
                        console.log('Found', gltfAnimations.length, 'animations:', gltfAnimations.map(anim => anim.name || 'Unnamed'));
                        
                        // Update all keyframes with available animations
                        updateKeyframesWithAnimations(gltfAnimations);
                    }
                    
                    // Scale and position the model
                    const box = new THREE.Box3().setFromObject(currentModel);
                    const size = box.getSize(new THREE.Vector3());
                    const maxSize = Math.max(size.x, size.y, size.z);
                    const scale = 2 / maxSize;
                    currentModel.scale.setScalar(scale);
                    
                    // Center the model
                    const center = box.getCenter(new THREE.Vector3());
                    currentModel.position.sub(center.multiplyScalar(scale));
                    
                    currentModel.traverse((child) => {
                        if (child.isMesh) {
                            child.castShadow = true;
                            child.receiveShadow = true;
                        }
                    });
                    
                    scene.add(currentModel);
                    
                    console.log('External model setup complete');
                },
                function(progress) {
                    const percentage = (progress.loaded / progress.total * 100);
                    console.log('Loading progress:', percentage + '%');
                },
                function(error) {
                    console.error('Error loading external model:', error);
                    console.log('Keeping default model');
                }
            );
        }
        
        function updateKeyframesWithAnimations(animations) {
            const animationNames = animations.map((anim, index) => anim.name || `Animation ${index + 1}`);
            
            // This would ideally update the keyframes in the editor, but since we're in exported HTML,
            // we'll just log the available animations for now
            console.log('Available animations for keyframes:', animationNames);
        }
        
        function playKeyframeAnimation(keyframe) {
            if (!mixer || !gltfAnimations.length || !keyframe.playAnimation || !keyframe.selectedAnimation) {
                return;
            }
            
            // Stop current animation
            if (currentAnimationAction) {
                currentAnimationAction.stop();
            }
            
            // Find the selected animation
            const selectedAnim = gltfAnimations.find(anim => 
                (anim.name || `Animation ${gltfAnimations.indexOf(anim) + 1}`) === keyframe.selectedAnimation
            );
            
            if (selectedAnim) {
                currentAnimationAction = mixer.clipAction(selectedAnim);
                currentAnimationAction.reset();
                currentAnimationAction.play();
                console.log('Playing animation:', keyframe.selectedAnimation);
            }
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            if (mixer) {
                mixer.update(0.016);
            }
            
            // Check if current keyframe has auto-rotate enabled
            const scrollPercent = getScrollPercentage();
            const activeKeyframes = keyframes.filter(kf => 
                scrollPercent >= kf.startScroll && scrollPercent <= kf.endScroll
            );
            
            if (activeKeyframes.length > 0) {
                const activeKeyframe = activeKeyframes[0];
                
                // Handle auto-rotate
                if (activeKeyframe.autoRotate && currentModel) {
                    const rotationSpeedX = activeKeyframe.autoRotateSpeed?.x || 0.005;
                    const rotationSpeedY = activeKeyframe.autoRotateSpeed?.y || 0.01;
                    currentModel.rotation.x += rotationSpeedX;
                    currentModel.rotation.y += rotationSpeedY;
                }
                
                // Handle GLTF animations
                playKeyframeAnimation(activeKeyframe);
            }
            
            renderer.render(scene, camera);
        }
        
        function updateAnimation() {
            if (!currentModel || !isModelLoaded) return;
            
            const scrollPercent = getScrollPercentage();
            
            // Find active keyframes
            const activeKeyframes = keyframes.filter(kf => 
                scrollPercent >= kf.startScroll && scrollPercent <= kf.endScroll
            );
            
            if (activeKeyframes.length === 0) return;
            
            // Use the first active keyframe
            const keyframe = activeKeyframes[0];
            const progress = (scrollPercent - keyframe.startScroll) / 
                            (keyframe.endScroll - keyframe.startScroll);
            const easedProgress = easeInOut(Math.max(0, Math.min(1, progress)));
            
            // Apply transformations
            if (keyframe.transform) {
                // Position
                if (keyframe.transform.position) {
                    const startPos = keyframe.transform.position.start;
                    const endPos = keyframe.transform.position.end;
                    currentModel.position.set(
                        lerp(startPos.x, endPos.x, easedProgress),
                        lerp(startPos.y, endPos.y, easedProgress),
                        lerp(startPos.z, endPos.z, easedProgress)
                    );
                }
                
                // Rotation
                if (keyframe.transform.rotation) {
                    const startRot = keyframe.transform.rotation.start;
                    const endRot = keyframe.transform.rotation.end;
                    currentModel.rotation.set(
                        lerp(startRot.x, endRot.x, easedProgress),
                        lerp(startRot.y, endRot.y, easedProgress),
                        lerp(startRot.z, endRot.z, easedProgress)
                    );
                }
                
                // Scale
                if (keyframe.transform.scale) {
                    const startScale = keyframe.transform.scale.start;
                    const endScale = keyframe.transform.scale.end;
                    currentModel.scale.set(
                        lerp(startScale.x, endScale.x, easedProgress),
                        lerp(startScale.y, endScale.y, easedProgress),
                        lerp(startScale.z, endScale.z, easedProgress)
                    );
                }
            }
            
            // Apply camera transformations
            if (keyframe.camera) {
                if (keyframe.camera.position) {
                    const startCamPos = keyframe.camera.position.start;
                    const endCamPos = keyframe.camera.position.end;
                    camera.position.set(
                        lerp(startCamPos.x, endCamPos.x, easedProgress),
                        lerp(startCamPos.y, endCamPos.y, easedProgress),
                        lerp(startCamPos.z, endCamPos.z, easedProgress)
                    );
                }
                
                if (keyframe.camera.target) {
                    const startTarget = keyframe.camera.target.start;
                    const endTarget = keyframe.camera.target.end;
                    const targetVector = new THREE.Vector3(
                        lerp(startTarget.x, endTarget.x, easedProgress),
                        lerp(startTarget.y, endTarget.y, easedProgress),
                        lerp(startTarget.z, endTarget.z, easedProgress)
                    );
                    camera.lookAt(targetVector);
                }
            }
        }
        
        function getScrollPercentage() {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
            return Math.min(100, Math.max(0, (scrollTop / scrollHeight) * 100));
        }
        
        function lerp(start, end, progress) {
            return start + (end - start) * progress;
        }
        
        function easeInOut(t) {
            return t * t * (3.0 - 2.0 * t);
        }
        
        // Event listeners
        window.addEventListener('scroll', updateAnimation);
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // Initialize when page loads
        window.addEventListener('load', initScene);
        
        // Also try to initialize immediately in case load event already fired
        if (document.readyState === 'complete') {
            initScene();
        }
        
        // Custom user code
        
        
        // Log initialization
        console.log('ScrollScape 3D Animation script loaded');
        console.log('Keyframes:', keyframes);
    </script>
  </body>
</html>
